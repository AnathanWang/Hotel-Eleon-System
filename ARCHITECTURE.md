# Архитектура модуля Солянова А.А.

## Обзор модуля номеров и бронирования

Модуль реализует полный цикл управления номерным фондом и бронированиями отеля с применением принципов ООП.

## Структура данных

### Модель Room (Номер)
```python
class Room(db.Model):
    - id: Integer (PK)
    - number: String (уникальный)
    - room_type: String (standard/deluxe/suite/family)
    - floor: Integer
    - capacity: Integer (вместимость)
    - price_per_night: Float (цена за ночь)
    - description: Text
    - is_available: Boolean
    
    Методы:
    - is_available_for_period() - проверка доступности
    - calculate_total_price() - расчет стоимости
    - get_type_display() - название типа
```

### Модель Booking (Бронирование)
```python
class Booking(db.Model):
    - id: Integer (PK)
    - room_id: Integer (FK → rooms.id)
    - guest_name: String
    - guest_phone: String
    - guest_email: String
    - check_in: Date
    - check_out: Date
    - total_price: Float
    - status: String (pending/confirmed/checked_in/checked_out/cancelled)
    - special_requests: Text
    - created_at: DateTime
    
    Методы:
    - confirm() - подтверждение брони
    - check_in_guest() - заселение
    - check_out_guest() - выселение
    - cancel() - отмена
    - get_nights_count() - количество ночей
```

## Бизнес-логика

### Алгоритм поиска свободных номеров

1. Получение всех номеров по фильтрам (тип, вместимость)
2. Для каждого номера проверка пересечений с существующими бронированиями:
   - Бронь начинается до выезда искомой даты
   - Бронь заканчивается после заезда искомой даты
   - Статус брони: подтверждено или заселен
3. Возврат только свободных номеров

### Автоматизация

- **Автоматический расчет цены** при создании номера на основе типа
- **Автоматический расчет стоимости** бронирования = цена × ночи
- **Автоматическая валидация дат** (выезд > заезд, заезд >= сегодня)
- **Каскадное удаление** бронирований при удалении номера

## Принципы ООП

### 1. Инкапсуляция
- Приватные методы: `_set_price_by_type()`, `_calculate_total_price()`
- Скрытие внутренней логики расчетов

### 2. Наследование
- `RoomType(Enum)` - наследование типов с общими свойствами
- `BookingStatus(Enum)` - наследование статусов

### 3. Полиморфизм
- Метод `to_dict()` для всех моделей
- Единый интерфейс для разных типов номеров

### 4. Абстракция
- Выделение ключевых свойств объектов (номер, бронь)
- Абстрагирование от деталей реализации

## Маршруты (Routes)

### Номера
- `/rooms` - список номеров с фильтрацией
- `/rooms/create` - создание номера
- `/rooms/<id>` - детали номера
- `/rooms/<id>/edit` - редактирование
- `/rooms/<id>/delete` - удаление

### Бронирования
- `/bookings` - список бронирований
- `/bookings/search` - поиск свободных номеров
- `/bookings/create` - создание бронирования
- `/bookings/<id>` - детали
- `/bookings/<id>/confirm` - подтверждение
- `/bookings/<id>/checkin` - заселение
- `/bookings/<id>/checkout` - выселение
- `/bookings/<id>/cancel` - отмена
- `/bookings/calendar` - календарь загруженности

## Особенности реализации

### Модульная архитектура (Flask Blueprints)
- Независимые модули `rooms` и `bookings`
- Легкое расширение и поддержка
- Возможность разработки параллельно

### База данных SQLite
- Простота развертывания
- Не требует установки сервера БД
- Подходит для небольших отелей

### Responsive UI (Bootstrap 5)
- Адаптивный дизайн для всех устройств
- Современный интерфейс
- Интерактивные элементы

### Календарь загруженности
- Визуализация занятости на месяц
- Интерактивные подсказки (tooltips)
- Навигация по месяцам
- Расчет процента загруженности

## Масштабируемость

Система спроектирована для легкого добавления новых модулей:
- Модуль гостей (Вершинина Н.Д.)
- Модуль финансов (Онучин К.С.)
- Модуль персонала
- Модуль услуг

Все модули будут использовать общую базу данных и интегрироваться через API.
